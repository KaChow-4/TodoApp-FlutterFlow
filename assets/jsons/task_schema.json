{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/tasks.schema.json",
  "title": "Tasks Collection",
  "description": "Schema for documents in the Firestore `tasks` collection.",
  "type": "object",
  "$defs": {
    "Timestamp": {
      "title": "Firestore-compatible timestamp",
      "description": "Accepts either an RFC 3339 date-time string (with timezone/offset) or a Firestore-like object with integer seconds and nanoseconds.",
      "oneOf": [
        {
          "type": "string",
          "format": "date-time",
          "examples": [
            "2026-02-05T22:56:19-05:00",
            "2026-02-06T14:46:27Z"
          ]
        },
        {
          "type": "object",
          "properties": {
            "seconds": { "type": "integer", "description": "Unix epoch seconds" },
            "nanoseconds": { "type": "integer", "minimum": 0, "maximum": 999999999 }
          },
          "required": ["seconds", "nanoseconds"],
          "additionalProperties": false,
          "examples": [
            { "seconds": 1738781779, "nanoseconds": 0 }
          ]
        }
      ]
    },
    "DocumentRefUsers": {
      "title": "Reference to a user document",
      "description": "Represents a Firestore document reference to the users collection, e.g., /users/{uid}. Accepts string paths or an object with a path property.",
      "oneOf": [
        {
          "type": "string",
          "pattern": "^/users/[A-Za-z0-9_\\-]{1,128}$",
          "examples": [
            "/users/i35HPz64Vnfxvg7lhWER4WV4jeP2",
            "/users/06mZ8ok5FWa08lvPCzA5QsQ7jQ62"
          ]
        },
        {
          "type": "object",
          "properties": {
            "path": {
              "type": "string",
              "pattern": "^/users/[A-Za-z0-9_\\-]{1,128}$"
            }
          },
          "required": ["path"],
          "additionalProperties": false
        }
      ]
    }
  },
  "properties": {
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "examples": ["get food"]
    },
    "details": {
      "type": "string",
      "maxLength": 5000,
      "examples": ["detail"]
    },
    "completed": {
      "type": "boolean",
      "default": false,
      "description": "Whether the task is completed."
    },
    "comleted": {
      "type": "boolean",
      "deprecated": true,
      "description": "Deprecated misspelling of `completed`. Prefer `completed`."
    },
    "created": {
      "$ref": "#/$defs/Timestamp",
      "description": "When the task was created.",
      "readOnly": true,
      "examples": ["2026-02-05T22:56:19-05:00"]
    },
    "user": {
      "$ref": "#/$defs/DocumentRefUsers",
      "description": "Reference to the owning user document.",
      "examples": ["/users/06mZ8ok5FWa08lvPCzA5QsQ7jQ62"]
    }
  },
  "anyOf": [
    { "required": ["completed"] },
    { "required": ["comleted"] }
  ],
  "required": ["title", "created", "user"],
  "additionalProperties": false
}
