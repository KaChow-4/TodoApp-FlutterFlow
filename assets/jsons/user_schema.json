{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/users.schema.json",
  "title": "Users Collection",
  "description": "Schema for documents in the Firestore `users` collection.",
  "type": "object",
  "$defs": {
    "Timestamp": {
      "title": "Firestore-compatible timestamp",
      "description": "Accepts either an RFC 3339 date-time string (with timezone/offset) or a Firestore-like object with integer seconds and nanoseconds.",
      "oneOf": [
        {
          "type": "string",
          "format": "date-time",
          "examples": [
            "2026-02-06T09:46:27-05:00",
            "2004-10-16T00:00:00-04:00",
            "2026-02-06T14:46:27Z"
          ]
        },
        {
          "type": "object",
          "properties": {
            "seconds": { "type": "integer", "description": "Unix epoch seconds" },
            "nanoseconds": { "type": "integer", "minimum": 0, "maximum": 999999999 }
          },
          "required": ["seconds", "nanoseconds"],
          "additionalProperties": false,
          "examples": [
            { "seconds": 1738859187, "nanoseconds": 0 }
          ]
        }
      ]
    }
  },
  "properties": {
    "uid": {
      "type": "string",
      "description": "Firebase Auth UID for the user.",
      "minLength": 1,
      "maxLength": 128,
      "pattern": "^[A-Za-z0-9_\\-]+$",
      "examples": ["i35HPz64Vnfxvg7lhWER4WV4jeP2"]
    },
    "display_name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "examples": ["Ryan C"]
    },
    "email": {
      "type": "string",
      "format": "email",
      "maxLength": 320,
      "examples": ["ryan.chhay@uri.edu"]
    },
    "phone_number": {
      "description": "User phone number as E.164 or 10-digit US/CA digits.",
      "oneOf": [
        { "type": "string", "pattern": "^\\+?[1-9]\\d{1,14}$", "examples": ["+14014014014"] },
        { "type": "string", "pattern": "^\\d{10}$", "examples": ["4014014014"] }
      ]
    },
    "photo_url": {
      "type": "string",
      "format": "uri",
      "maxLength": 2048,
      "examples": [
        "https://firebasestorage.googleapis.com/v0/b/todo-1xhj57.firebasestorage.app/o/users%2Fi35HPz64Vnfxvg7lhWER4WV4jeP2%2Fuploads%2F1770389247110000.jpg?alt=media&token=6dba52f0-1432-48e9-ad88-51e73f8dd5f4"
      ]
    },
    "birthday": {
      "$ref": "#/$defs/Timestamp",
      "description": "The user's birthday. Optional and may be null.",
      "nullable": true
    },
    "created_time": {
      "$ref": "#/$defs/Timestamp",
      "description": "When the user document was created.",
      "readOnly": true,
      "examples": ["2026-02-06T09:46:27-05:00"]
    }
  },
  "required": ["uid", "display_name", "email", "created_time"],
  "additionalProperties": false
}
